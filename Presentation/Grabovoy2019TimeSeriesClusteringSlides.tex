\documentclass[10pt,pdf,hyperref={unicode}]{beamer}
\beamertemplatenavigationsymbolsempty

\setbeamertemplate{blocks}[rounded=true, shadow=true]
\setbeamertemplate{footline}[page number]
\usepackage{multicol}

\usefonttheme{serif}

\usepackage[utf8]{inputenc}
\usepackage[english, russian]{babel}
\usepackage{amsmath,mathrsfs,mathtext}
\usepackage{graphicx, epsfig}
\usepackage{caption}
\usepackage{subfig}
\usepackage{amsmath, bm}

\usepackage{tabularx}

\usepackage{tikz}

\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

\makeatletter
\let\@@magyar@captionfix\relax
\makeatother

\usetheme{Warsaw}
\usecolortheme{sidebartab}
\definecolor{beamer@blendedblue}{RGB}{31,96,49}

\setbeamertemplate{enumerate items}[circle]

\setbeamersize{text margin left=1.5em, text margin right=1.5em}

%----------------------------------------------------------------------------------------------------------
\title[\hbox to 56mm{Анализ свойств локальных моделей... \hfill\insertframenumber\,/\,\inserttotalframenumber}]
{Анализ свойств локальных моделей в задачах кластеризации квазипериодических временных рядов}
\author[Грабовой А. В.]{\Large Грабовой Андрей Валериевич}
\institute{ Московский физико-технический институт\\
Факультет управления и прикладной математики\\
Кафедра интеллектуальных систем\\
~\\
Научный руководитель д.ф.-м.н. В. В. Стрижов
}

\date{\footnotesize{\emph{Москва,}\\
 2019г}}
%----------------------------------------------------------------------------------------------------------
\begin{document}
%----------------------------------------------------------------------------------------------------------
\begin{frame}
\titlepage
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Цель работы}
	\begin{block}{Исследуется}
		Исследуется задача поиска характерных переодических структур внетри временного ряда.
	\end{block}
	
	\begin{block}{Требуется}
		Требуется предложить алгоритм поиска характерных сегментов, который основывается на методе главных компонент для локального снижения размерности.
	\end{block}
	
	\begin{block}{Проблемы}
		Построение признакового описания точек временного ряда низкой размерности.
	\end{block}
	
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Список литературы}
	\begin{itemize}
		\item \textit{И. П. Ивкин,  М. П. Кузнецов} Алгоритм классификации временных рядов акселерометра по комбинированному признаковому описанию.~// Машинное обучение и анализ данных, 2015.
		\item \textit{V. V. Strijov, A. M. Katrutsa} Stresstes procedures for features selection algorithms.~// Schemometrics and Intelligent Laboratory System, 2015.
		\item	\textit{A. D. Ignatov, V. V. Strijov} Human activity recognition using quasiperiodic time series collected from a single tri-axial accelerometer.~// Multimedial Tools and Applications, 2015.
		\item \textit{I. Borg, P. J. F. Groenen} Modern Multidimensional Scaling. --- New York: Springer, 2005. 540 p.
		\item \textit{Д. Л. Данилова, А. А. Жигловский} Главные компоненты временных рядов: метод "Гусеница". --- СПбУ, 1997.
	\end{itemize}
\end{frame}

%----------------------------------------------------------------------------------------------------------
\begin{frame}[shrink=5]{Постановка задачи}

\begin{center}
	\begin{columns}
   		 \begin{column}{0.7\textwidth}
        			\includegraphics[width=1\textwidth]{results/example_slides}
			
			 Задан временной ряд: $$\textbf{x}~\in~\mathbb{R}^{\text{N}},~\quad~\textbf{x}~=~[\textbf{v}_1,~\cdots, \textbf{v}_M],~\quad~\textbf{v}_i~\in~\mathcal{V},$$\\ где $\mathcal{V}$ множество возможных сегментов в ряде $\textbf{x}$.
   		 \end{column}
   		 \begin{column}{0.55\textwidth}
        			\includegraphics[width=1\textwidth]{results/example_phase}
			
			Проекция фазовых траекторий на первые две главные компоненты.
    		\end{column}
	\end{columns}
\end{center}

Предположения:
\begin{itemize}
	\item число различных действий внутри временного ряда известно и равно~$K$,
	\item для всех~$\textbf{v} \in \mathcal{V}$ выполняется~$\left|\textbf{v}\right| \leq T$, где~$\left|\textbf{v}\right|$ длина сегмента,
	\item для всех~$i$ либо~$[\textbf{v}_{i-1},\textbf{v}_{i}]$ либо~$[\textbf{v}_{i},\textbf{v}_{i+1}]$  является цепочкой действий.
\end{itemize}

\end{frame}

%----------------------------------------------------------------------------------------------------------
\begin{frame}[shrink=5]{Постановка задачи кластеризации точек}

Рассматривается отображение
$$
a : t \to \mathbb{Y} = \{1,\cdots, K\}, 
$$
где~$t \in \{1,\cdots, N\}$ некоторый момент времени, на котором задан временной ряд.
Требуется, чтобы отображение~$a$ удовлетворяло следующим свойствам:

$$
\begin{cases}
    a\left(t_1\right) = a\left(t_2\right), &  \text{если в моменты } t_1, t_2 \text{ совершается один тип действий}\\
    a\left(t_1\right) \not= a\left(t_2\right), &  \text{если в моменты } t_1, t_2 \text{ совершаются разные типы действий }
\end{cases}
$$

Пусть задана асессорская разметка точек временного ряда:
$$
\textbf{y} \in \{1,\cdots,K\}^{N}.
$$
Ошибка алгоритма~$a$ на временном ряде~$\textbf{x}$:
$$
S = \frac{1}{N}\sum_{t=1}^{N}[y_t = a\left(t\right)],
$$
где~$t$~---~момент времени,~$y_t$ асессорская разметка~$t$-го момента времени для заданого временного ряда.

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Кластеризация точек}
Фазовая траектория ряда $\textbf{x}$:
$$\mathbf{H} = \{\textbf{h}_t| \textbf{h}_t = [x_{t-T}, x_{t-T+1}, \cdots, x_{t}],~T\leq t\leq N\},$$
где $\textbf{h}_t$~---~точка фазовой траектории.

~\\
Фазовые подпространства:
$$\mathbf{S} = \{\textbf{s}_t| \textbf{s}_t = [\textbf{h}_{t-T}, \textbf{h}_{t-T+1}, \cdots, \textbf{h}_{t+T-1}],~T\leq t\leq N-T\},$$
где $\textbf{s}_t$~---~это сегмент фазовой траектории.

~\\
Множество базисов:
$$\mathbf{W} = \{\textbf{W}_t| \textbf{W}_t = [\textbf{w}^1_t, \textbf{w}^2_t]\}, \quad \bm{\Lambda} = \{\bm{\lambda}_t| \bm{\lambda}_t=[\lambda^1_t, \lambda^2_t]\},$$
где~$[\textbf{w}^1_t, \textbf{w}^2_t]$ и~$[\lambda^1_t, \lambda^2_t]$ это базисные векторы и соответствующие им собственные числа для сегмента фазовой траектории~$\textbf{s}_t$.
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}[shrink=5]{Функция расстояния (общий случай)}
Расстояние между элементами~$\mathbf{W}_{t_1},\mathbf{W}_{t_2}$:\\
$$\rho\left(\textbf{W}_1, \textbf{W}_2\right) = \max\left(\max_{\textbf{e}_2 \in \textbf{W}_2} d_{1}\left(\textbf{e}_2\right), \max_{\textbf{e}_1 \in \textbf{W}_1} d_{2}\left(\textbf{e}_1\right)\right),$$
где ~$\textbf{e}_i$ это базисный вектор пространства~$\textbf{W}_i,$ а~$d_i\left(\textbf{e}\right)$ является расстоянием от вектора~$\textbf{e}$ до пространства~$\textbf{W}_i$.

\begin{block}{Теорема (Грабовой 2019)}
\textit{Пусть задано множество подпространств~$\mathbb{W}$ пространства~$\mathbb{R}^{n}$. Каждое подпространство которого задается базисом~$\mathbf{W}_i\in \mathbf{W}$, тогда функция расстояния~$\rho\left(\textbf{W}_1, \textbf{W}_2\right)$ является метрикой заданой на множестве базисов~$\mathbf{W}$:
$$
\rho\left(\textbf{W}_1, \textbf{W}_2\right) = \max\left(\max_{\textbf{e}_2 \in \textbf{W}_2} d_{1}\left(\textbf{e}_2\right), \max_{\textbf{e}_1 \in \textbf{W}_1} d_{2}\left(\textbf{e}_1\right)\right),
$$
где~$\textbf{e}_i$ это базисный вектор из~$\textbf{W}_i$, a~$d_i\left(\textbf{e}\right)$ является расстоянием от вектора~$\textbf{e}$ до пространства заданого базисом~$\textbf{W}_i$.
}
\end{block}
\end{frame}

%----------------------------------------------------------------------------------------------------------
\begin{frame}[shrink=5]{Функция расстояния (вспомогательные леммы)}

\begin{block}{Лемма 1 (Грабовой 2019)}
\textit{Пусть заданы два подпространства~$\mathbb{X}, \mathbb{Y} \subset \mathbb{R}^{n}$, которые задаются базисами~$\textbf{W}_1$ и~$\textbf{W}_2$, тогда справедливо следующее условие:}

$$
\max_{\textbf{a} \in \mathbb{X}:~\left|\left|\textbf{a}\right|\right|\leq 1}d_2\left(\textbf{a}\right) = \max_{\textbf{a} \in \mathbb{X}:~\left|\left|\textbf{a}\right|\right|= 1}d_2\left(\textbf{a}\right)
$$
\textit{где~$d_i\left(\textbf{a}\right)$ является расстоянием от вектора~$\textbf{a}$ до пространства заданого базисом~$\textbf{W}_i$.
}
\end{block}

\begin{block}{Лемма 2 (Грабовой 2019)}
\textit{Пусть заданы подпространства~$\mathbb{X}, \mathbb{Y}, \mathbb{Z} \subset \mathbb{R}^{n}$, которые задаются базисами~$\textbf{W}_1, \textbf{W}_2, \textbf{W}_3$ соответственно, тогда справедливо следующее условие:}

$$
\max_{\substack{\textbf{x} \in \mathbb{X} \\ \left|\left|\textbf{x}\right|\right|\leq 1}}\min_{\substack{\textbf{y} \in \mathbb{Y} \\ \left|\left|\textbf{y}\right|\right|\leq 1}}||\textbf{x}-\textbf{y}||\leq 
\max_{\substack{\textbf{x} \in \mathbb{X} \\ \left|\left|\textbf{x}\right|\right|\leq 1}}\min_{\substack{\textbf{z} \in \mathbb{Z} \\ \left|\left|\textbf{z}\right|\right|\leq 1}}||\textbf{x}-\textbf{z}|| + 
\max_{\substack{\textbf{z} \in \mathbb{Z} \\ \left|\left|\textbf{z}\right|\right|\leq 1}}\min_{\substack{\textbf{y} \in \mathbb{Y} \\ \left|\left|\textbf{y}\right|\right|\leq 1}}||\textbf{z}-\textbf{y}||.
$$
\end{block}

\end{frame}

%----------------------------------------------------------------------------------------------------------

\begin{frame}[shrink=5]{Функция расстояния (двумерный случай)}
Расстояние между элементами~$\mathbf{W}_{t_1},\mathbf{W}_{t_2}$:\\
$$
\rho\left(\textbf{W}_1, \textbf{W}_2\right) = \max_{\{\textbf{a},\textbf{b},\textbf{c}\} \subset \textbf{W}_1\cup \textbf{W}_2 } V\left(\textbf{a},\textbf{b},\textbf{c}\right), 
$$
где~$\textbf{W}_1\cup\textbf{W}_2$ это объединение базисных векторов первого и второго пространства,~$V\left(\textbf{a},\textbf{b},\textbf{c}\right)$~---~объем параллелепипеда построенного на векторах~$\textbf{a}, \textbf{b}, \textbf{c}$, которые являются столбцами матрицы~$\textbf{W}_1\cup\textbf{W}_2$.

~\\
Расстояние между элементами $\mathcal{L}$:\\
$$
\rho\left(\bm{\lambda}_1, \bm{\lambda}_2\right) = \sqrt[]{\left(\bm{\lambda}_1 - \bm{\lambda}_2\right)^{\mathsf{T}}\left(\bm{\lambda}_1 - \bm{\lambda}_2\right)}.
$$

~\\
Расстояние между точками временного ряда:\\
$$
\rho\left(t_1, t_2\right) = \rho\left(\textbf{W}_1, \textbf{W}_2\right) + \rho\left(\bm{\lambda}_1, \bm{\lambda}_2\right).
$$

~\\
Матрица попарных растояний:\\
$$\textbf{M} = \mathbb{R}_{+}^{N\times N}.$$

\end{frame}
%----------------------------------------------------------------------------------------------------------


\begin{frame}[shrink=5]{Описание временных рядов в эксперименте}

\begin{itemize}
	\item Physical Motion --- реальные временные ряды, которые получены при помощи мобильного акселерометра.  
	
	Характерные действия: ходьба, бег, приседания.
	\item Synthetic --- синтетические временные ряды, которые были построены при помощи нескольких первых слагаемых ряда Фурье со случайными коэффициентами из стандартного нормального распределения. 
\end{itemize}

~\\
\begin{tabular}{|c|c|c|c|c|}
\hline
	Ряд,~$\textbf{x}$ &Длина,~$N$& Сегментов,~$K$&Длина,~$T$& Ошибка,~$S$\\
	\hline
	\multicolumn{1}{|l|}{Phys.~Motion~1}
	& 900& 2& 40& 0.06\\
	\hline
	\multicolumn{1}{|l|}{Phys.~Motion~2}
	& 900& 2& 40& 0.03\\
	\hline
	\multicolumn{1}{|l|}{Synthetic~1}
	& 2000& 2& 20& 0.04\\
	\hline
	\multicolumn{1}{|l|}{Synthetic~2}
	& 2000& 3& 20& 0.03\\
\hline
\end{tabular}

~\\
\begin{itemize}
	\item $N$ --- число точек во временном ряде,
	\item $K$ --- число различных действий во временном ряде,
	\item $T$ --- максимальная длина сегмента,
	\item $S$ --- точность кластеризации.
\end{itemize}

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}[shrink=5]{Пример временных рядов}

\begin{columns}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/2_patern_2_series}
    \end{column}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/3_patern_2_series}
    \end{column}
\end{columns}

\begin{columns}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/real_1_series}
    \end{column}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/real_2_series}
    \end{column}
\end{columns}

Временные ряды построенные синтетически, а также при помощи мобильного акселерометра.

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}[shrink=5]{Матрица попарных расстояний $\textbf{M}$}

\begin{columns}
    \begin{column}{0.35\textwidth}
        \includegraphics[width=1\textwidth]{results/2_patern_2_full}
    \end{column}
    \begin{column}{0.35\textwidth}
        \includegraphics[width=1\textwidth]{results/3_patern_2_full}
    \end{column}
\end{columns}

\begin{columns}
    \begin{column}{0.35\textwidth}
        \includegraphics[width=1\textwidth]{results/real_1_full}
    \end{column}
    \begin{column}{0.35\textwidth}
        \includegraphics[width=1\textwidth]{results/real_2_full}
    \end{column}
\end{columns}

Матрицы попарных расстояний для временных рядов, построенных синтетически, а также при помощи мобильного акселерометра.

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}[shrink=5]{Проекция точек фазовой траектории на плоскость}

\begin{columns}
    \begin{column}{0.35\textwidth}
        \includegraphics[width=1\textwidth]{results/2_patern_2_2D_vector}
    \end{column}
    \begin{column}{0.35\textwidth}
        \includegraphics[width=1\textwidth]{results/3_patern_2_2D_vector}
    \end{column}
\end{columns}

\begin{columns}
    \begin{column}{0.35\textwidth}
        \includegraphics[width=1\textwidth]{results/real_1_2D_vector}
    \end{column}
    \begin{column}{0.35\textwidth}
        \includegraphics[width=1\textwidth]{results/real_2_2D_vector}
    \end{column}
\end{columns}

Иллюстрация проекции признакового описания точек временного ряда на плоскости для временных рядов, построенных синтетически, а также при помощи мобильного акселерометра.

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}[shrink=5]{Кластеризация точек временного ряда}

\begin{columns}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/2_patern_2_claster_vector}
    \end{column}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/3_patern_2_claster_vector}
    \end{column}
\end{columns}

\begin{columns}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/real_1_claster_vector}
    \end{column}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/real_2_claster_vector}
    \end{column}
\end{columns}

Результат кластеризации точек временных рядов, построенных синтетически, а также при помощи мобильного акселерометра.

\end{frame}
%----------------------------------------------------------------------------------------------------------

\begin{frame}[shrink=5]{Сегментация временных рядов}

\begin{columns}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/simple_1_claster_vector}
    \end{column}
    \begin{column}{0.3\textwidth}
        \includegraphics[width=1\textwidth]{results/simple_1_phase_space0}
    \end{column}
\end{columns}

\begin{columns}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=1\textwidth]{results/real_2_segmentation_vector}
    \end{column}
    \begin{column}{0.3\textwidth}
        \includegraphics[width=1\textwidth]{results/real_2_phase_space1}
    \end{column}
\end{columns}

Результат сегментации временных рядов, в случае двух синусоидальных сигналов в произвольной частотой и амплитудой, а также в случае реальных данных, полученных при помощи акселерометра.

\end{frame}
%----------------------------------------------------------------------------------------------------------

\begin{frame}[shrink=5]{Выносится на защиту}
	\begin{enumerate}
		\item Предложен алгоритм поиска характерных сегментов, который основывается на методе главных компонент для локального снижения размерности
		\item Введена функция расстояния между локальными базисами в каждый момент времени, которые интерпретировались как признаковое описание точки временного ряда. Данная функция является метрикой.
		\item В ходе эксперимента, на реальных показаниях акселерометра, а также на синтетических данных, было показано, что предложенный метод измерение расстояния между базисами хорошо разделяет точки которые принадлежат различным действиям, что приводит к хорошей кластеризации объектов.
		\item Также в эксперименте была проведена полная сегментация временных рядов для каждого кластера по отдельности.
	\end{enumerate}
	
	Планируется решить задачу нахождения минимального размера фазового пространства, для которого  фазовая траектория не имеет самопересечений.
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Публикации}
	\begin{enumerate}
		\item \textit{Грабовой А. В., Стрижов В. В.} Анализ свойств локальных моделей в задачах кластеризации квазипериодических временных рядов // (в процессе)
		\item \textit{Грабовой А. В., Бахтеев О. Ю., Стрижов В. В.} Определение релевантности параметров нейросети // Информатика и ее применения, 2019, 13(2).
		\item \textit{Гадаев Т. Т., Грабовой А. В., Мотренко А. П., Стрижов В. В.} Численные методы оценки объема выборки в задачах регрессии и классификации //(в процессе)
		\item \textit{Бучнев Т. Т., Грабовой А. В., Гадаев Т. Т., Стрижов В. В.} Ранее прогнозирование достаточного объема выборки для обобщенно линейной модели // (в процессе)
	\end{enumerate}
\end{frame}
%----------------------------------------------------------------------------------------------------------

\end{document} 